## Подготовка

### Клиент BitTorrent

Подойдет любой, но я рекомендую Transmission: https://transmissionbt.com/  
После установки и запуска заходим в настройки и включаем UPnP:  
![7f3b31baf96c1c839fb757b94f375a0a.png](../_resources/7f3b31baf96c1c839fb757b94f375a0a.png)  
Также можно нажать Test Port для проверки, должно быть open, но если нет, не страшно, работать будет.

### Что ещё скачать

1.  Более-менее безопасно использовать официальные образа MSDN из раздела "Оригинальные версии Windows" торрент трекера https://nnmclub.to  
Рекомендуется английская версия, на которую после установки и при необходимости можно штатными средствами добавить локализацию на любой язык. В том числе, таким образом, можно сделать различную локализацию для разных пользователей.  
На момент написания этого гайда актуальная версия официальной сборки называется `Microsoft Windows 11 [10.0.22631.3155]`,  
а файл образа: `en-us_windows_11_consumer_editions_version_23h2_updated_feb_2024_x64_dvd_9665512b.iso`  
Magnet ссылка для торрент клиента: [magnet:?xt=urn:btih:54686eb574adac71e27c2cb700b842abfd2538df&tr=http%3A%2F%2Fbt02.nnm-club.cc%3A2710%2F0022eb9d068a98da70412b421c849dcd%2Fannounce&tr=http%3A%2F%2Fbt02.nnm-club.cc%3A2710%2F0022eb9d068a98da70412b421c849dcd%2Fannounce](magnet:?xt=urn:btih:54686eb574adac71e27c2cb700b842abfd2538df&tr=http%3A%2F%2Fbt02.nnm-club.cc%3A2710%2F0022eb9d068a98da70412b421c849dcd%2Fannounce&tr=http%3A%2F%2Fbt02.nnm-club.cc%3A2710%2F0022eb9d068a98da70412b421c849dcd%2Fannounce)  
Если не работает клик по ссылке, то в торрент клиенте: File - Open URL.  
После добавления и начала скачивания - двойной клик по скачиваемому торренту и снимаем галки с ненужных файлов:  
![6fa35f7aad41a5e34192f04a07b7cd5a.png](../_resources/6fa35f7aad41a5e34192f04a07b7cd5a.png)
    
2.  Эмулятор KMS для лицензирования, это архив, пароль 2023 (пока не распаковывать!): https://github.com/abbodi1406/KMS_VL_ALL_AIO/releases/download/v0.51.0/KMS_VL_ALL_AIO-51.7z
    
3.  Rufus - софт для нарезания правильных флешек: https://github.com/pbatard/rufus/releases/download/v4.4/rufus-4.4.exe
    
4.  Архиватор 7-Zip: https://www.7-zip.org/a/7z2301-x64.exe
    

### Создание флешки

Как скачается образ из торрента - вставляем шуструю флешку объемом минимум 8 ГБ (все данные на ней будут уничтожены!), запускаем Rufus и настраиваем:  
0\. Выбираем свою флешку

1.  Нажимаем select и выбираем скачанный образ
2.  GPT
3.  UEFI  
    ![8bf697fe563d1ab2c812effc02b2e701.png](../_resources/8bf697fe563d1ab2c812effc02b2e701.png)  
    И поехали - Start  
    Всплывет окно где можно включить различные костыли и велосипеды, не рекомендую что либо включать без особой необходимости.  
    ![3f0929018a6669c569490deb63b496ae.png](../_resources/3f0929018a6669c569490deb63b496ae.png)  
    По окончанию копируем на флешку (в корень или создать директорию для софта) архив с эмулятором KMS и 7-Zip.

## Установка Windows 11

### Отключаем лишнее

Выключаем компьютер, разбираем и отключаем все накопители (диски, SSD) кроме того, на который планируется установка Windows.  
Также отключаем все флешки кроме той, которую приготовили в предыдущей главе.  
По возможности лучше вообще отключить все лишнее, всякие дополнительные сетевые карты, WiFi адаптеры (если интернет идет по кабелю, а они не нужны), кард-ридеры, и т.п.

### Проверка и подготовка BIOS

Включаем компьютер и сразу ломимся в биос, вероятно это кнопки F2, F9, F10 или, скорее всего - Delete

#### Compatibility Support Module сокращенно CSM.

Это может быть настройка CSM вкл-выкл (тогда надо выключить), может быть что то вроде boot mode с вариантами UEFI или CSM, в любом случае надо CSM выключить, что бы компьютер грузился только через EFI (UEFI).

#### Secure boot

Его тоже надо выключить, эта система уже давно не дает плюсов по безопасности, но несет кучу рисков и проблем.

### Boot order

Находим и ставим вверх (первым на загрузку) свою флешку.  
Если флешка отображена дважды - наверх выносим ту запись, где указано EFI или UEFI.

#### Первый запуск с флеш

Выходим из биос с сохранением, компьютер перезагрузится и произойдет запуск с флешки.  
Вероятно она попросит ткнуть в любую кнопку для загрузки, быстро тыкаем.

#### Очистка диска

Для начала необходимо полностью очистить накопитель на который планируется установка. Не просто удалить все файлы, а убрать файловые системы, разделы, и даже разметку. Это легко сделать установщиком.

Сначала по дефолту:  
![b650ed15f783042381d7e13142f8b696.png](../_resources/b650ed15f783042381d7e13142f8b696.png)

Затем **Repair your computer**:  
![708e03cddbce27cc39b18d3cf8e9783a.png](../_resources/708e03cddbce27cc39b18d3cf8e9783a.png)

Выбираем Troubleshoot (других пунктов может быть больше чем на картинке):  
![24b18dc6a444b1e7cfb3a43af19716bd.png](../_resources/24b18dc6a444b1e7cfb3a43af19716bd.png)

Далее Command Prompt:  
![c17a084286446b0fc168eaf9d9c6913d.png](../_resources/c17a084286446b0fc168eaf9d9c6913d.png)

Откроется терминал, запускаем там diskpart:  
![2165316c5fe678856dca7c41bd406358.png](../_resources/2165316c5fe678856dca7c41bd406358.png)

Даем ему команду list disk, он ответит списком накопителей.  
Их должно быть два! Флешка и накопитель на который планируется установка.  
Внимательно смотрим на объем и пытаемся понять кто есть кто, на примере ниже видно два накопителя, 64 гб SSD для установки и флешка на 32 гб (её объем будет виден не полностью, это норма). Порядок может быть любым.  
Но зная объем накопителя на который планируется установка - можно догадаться где он. Запоминаем его номер (ноль или единица)  
![264404acf2cc775ad572b3662cbc0540.png](../_resources/264404acf2cc775ad572b3662cbc0540.png)

Даем команду select disk и номер накопителя (а не флеш!).  
В моем случае это 0:  
![f3210be6d5034bc622a9d316ae0c1433.png](../_resources/f3210be6d5034bc622a9d316ae0c1433.png)

Далее команда clean - это полностью очистит накопитель:  
![a9f7e4ca4cd92f80e615223c36df1698.png](../_resources/a9f7e4ca4cd92f80e615223c36df1698.png)

Команда exit - покидаем diskpart:  
![5d8daff9331bbadc61450f3091aaba29.png](../_resources/5d8daff9331bbadc61450f3091aaba29.png)

И еще раз exit - закроется терминал. После чего выбираем выключить компьютер:  
![45e579b67f48784be47c8b4f91d6105f.png](../_resources/45e579b67f48784be47c8b4f91d6105f.png)

#### Установка

Включаем обратно, он загрузится с флеш, на первом экране все по умолчанию:  
![9bf9a3557265aecfed7fe7ea352fb195.png](../_resources/9bf9a3557265aecfed7fe7ea352fb195.png)

На втором Install:  
![ee206f8b4768753d048a90bd8d513089.png](../_resources/ee206f8b4768753d048a90bd8d513089.png)

Далее честно отвечаем, что ключа нет:  
![5973057cbc3fa348af158f33b92ea7b5.png](../_resources/5973057cbc3fa348af158f33b92ea7b5.png)

Выбираем Windows 11 Pro:  
![819f2d1089b16a709e2b4eac5732190a.png](../_resources/819f2d1089b16a709e2b4eac5732190a.png)

Соглашаемся не читая с лицензией:  
![639d20c1c45af759e09bfc896d8e7bfa.png](../_resources/639d20c1c45af759e09bfc896d8e7bfa.png)

Выбираем Custom:  
![56d5e8c0009a5aaf4451f9819a1dcffc.png](../_resources/56d5e8c0009a5aaf4451f9819a1dcffc.png)

Тут должен быть только один диск и он должен быть Unallocated, его и выбираем:  
![0048b3791355b4e55417513c7a017def.png](../_resources/0048b3791355b4e55417513c7a017def.png)

Далее смотрим как система распаковывает себя с флешки на накопитель, если и то и другое шустрое, да ещё и проц ого-го - можно удивится с какой скоростью это происходит, объемы там большие 6 гб на флеш превращаются в почти 30 на накопителе:  
![c1748051071ab0a16c18365c1c23dd6f.png](../_resources/c1748051071ab0a16c18365c1c23dd6f.png)

Далее она перезагрузится и продолжит установку сама, но возможно запустит инсталлер с флешки опять, тогда перезагружаемся, идем в биос и в boot order ставим наверх Windows Boot Manager - это загрузчик установленной системы.

#### Первый запуск

После установки, перезагрузки и просмотра анимашки - выбираем страну (это влияет на региональные стандарты надписи даты и т.п.):  
![1b635b5c6ddb86ef441119372ff5955f.png](../_resources/1b635b5c6ddb86ef441119372ff5955f.png)

Основную клавиатуру оставляем US и далее Skip добавление дополнительной, это будет позже:  
![2c1bfb3dd362afcae40a9bd1d01cd93b.png](../_resources/2c1bfb3dd362afcae40a9bd1d01cd93b.png)  
![3e0896566f66f0a9a832a9772183a92e.png](../_resources/3e0896566f66f0a9a832a9772183a92e.png)

Где то тут, если интернет идет не по кабелю, система спросит к какой WiFi сети подключится и попросит её пароль, выбираем, даем пароль.

Вероятно тут произойдет перезагрузка (но не обязательно).

#### Продолжение первой загрузки

Вводим имя устройства, можно Skip тогда будет рандомное, но лучше написать понятное название компьютера.  
По хорошей IT традиции имена компьютеров и серверов под управлением Windows пишем большими латинскими буквами:  
![a4ddf025b77a931df08262b5d99c3f37.png](../_resources/a4ddf025b77a931df08262b5d99c3f37.png)

Вероятно тут произойдет перезагрузка (но не обязательно).

Далее сетап для частника:  
![79fd76433072f588fdf67b952a2ae7fd.png](../_resources/79fd76433072f588fdf67b952a2ae7fd.png)

Соглашаемся на Microsoft аккаунт:  
![86a46b66f98725163f3f417c9566a100.png](../_resources/86a46b66f98725163f3f417c9566a100.png)

Вводим свою почту от Microsoft аккаунта или создаем его и почту нажав **Create one**, при желании тут же и почту под аккаунт получить можно:  
![4cd10fea87b7776e0aaaa7d4965f66f5.png](../_resources/4cd10fea87b7776e0aaaa7d4965f66f5.png)  
![aa263612aeebc86edc252ce6f8cf860b.png](../_resources/aa263612aeebc86edc252ce6f8cf860b.png)

Далее оно нас поприветствует и предложит восстановить старые баги, вирусы и мусор с предыдущей системы, отказываемся:  
![892b668cd72c115e4f4a555e6a88fdf1.png](../_resources/892b668cd72c115e4f4a555e6a88fdf1.png)

Создаем PIN, это уникальный код для входа только в этот компьютер, что бы хранить в тайне пароль от Microsoft аккаунта:  
![4262b935ac834d2d89e736536da4eefd.png](../_resources/4262b935ac834d2d89e736536da4eefd.png)  
![4bc962b3bbafae4f740d65929f5f796c.png](../_resources/4bc962b3bbafae4f740d65929f5f796c.png)

Соглашение на всякие анальные зонды, в целом ничего опасного и много полезного, можно не читая принять:  
![f3926a2c9e883ff66704b4f19fdf291f.png](../_resources/f3926a2c9e883ff66704b4f19fdf291f.png)

Оно предложит впарить чего то от разных партнеров и своих говнокодеров, лучше Skip:  
![3a500fc86a61a9d6d9b1809dfa62927e.png](../_resources/3a500fc86a61a9d6d9b1809dfa62927e.png)

Далее предложит спарится с Андроид телефоном:  
![948292b06a5f4504c011d96bc12b8684.png](../_resources/948292b06a5f4504c011d96bc12b8684.png)

Ещё предложит синхронизировать браузер Edge через Microsoft аккаунт, хорошее дело:  
![f06b0771a864dac0ecbeece2954e38fd.png](../_resources/f06b0771a864dac0ecbeece2954e38fd.png)

Сразу после появления рабочего стола ничего лучше не трогать, там дохулион процессов на фоне идут. Раскроем трей и ждем когда значек облака очухается, побелеет и перестанет быть перечеркнутым, не исключено, что при клике будет бесконечное обновление, если за минуту ничего не изменилось - перезагружаемся:  
![fed737aa47a405fbd7d0d8bc2b096145.png](../_resources/fed737aa47a405fbd7d0d8bc2b096145.png)  
![5c9b40250b579936d5e4f81d05e4dc32.png](../_resources/5c9b40250b579936d5e4f81d05e4dc32.png)

## Архиватор и Лицензирование

#### 7-Zip

Во первых понадобится архиватор, на флешке положен 7-Zip, запускаем установщик и устанавливаем:  
![14b0104e5522d2aa8cc87f837d1a1bc3.png](../_resources/14b0104e5522d2aa8cc87f837d1a1bc3.png)  
Запускаем 7-Zip от администратора, заходим в Tools - Options:  
![dff15f73a30e745b6556dc34a8666b1c.png](../_resources/dff15f73a30e745b6556dc34a8666b1c.png)  
![17996805f1afa68c4ab5d66f0bb1d25e.png](../_resources/17996805f1afa68c4ab5d66f0bb1d25e.png)  
И устанавливаем его как главный архиватор для всех пользователей, ибо штатный в Windows до сих пор кривой и работает не со всеми архивами:  
![d8321d7d0f1a3f60f47c36a92a1b1780.png](../_resources/d8321d7d0f1a3f60f47c36a92a1b1780.png)  
Там же можно выбрать другой язык интерфейса 7-Zip, он настраивается отдельно и не зависит от системы:  
![2723d48e7e7623640b717ec358204da5.png](../_resources/2723d48e7e7623640b717ec358204da5.png)

#### Лицензия

Нужно **временно** отключить антивирус:  
Пуск - Шестеренка (Settings) - Privacy & Security - Windows Security - Virus & Threat protection:  
![289077e8ebea5c23876039a7808d3dca.png](../_resources/289077e8ebea5c23876039a7808d3dca.png)  
![a8a96a69de0f5affab08226056139d7a.png](../_resources/a8a96a69de0f5affab08226056139d7a.png)

Откроется окно, там Manage settings и отключаем Real-time protection:  
![525b4a593b97ffe77be0e4cb440101dd.png](../_resources/525b4a593b97ffe77be0e4cb440101dd.png)  
![cdf34c9a446d73bdbf92cbc53f77670c.png](../_resources/cdf34c9a446d73bdbf92cbc53f77670c.png)

Затем сворачиваем (ещё пригодится!) окно антивируса и открываем архив KMS_VL_ALL_AIO-51 с флешки, всплывет окно, выбираем 7-Zip и Always, пароль на архив - 2023:  
![edd70eae77cc195b9a42f468700d64b9.png](../_resources/edd70eae77cc195b9a42f468700d64b9.png)

Переносим оттуда единственный файл на стол и запускаем его:  
![4daa8ec3db1d0f3e2262827eba922bc5.png](../_resources/4daa8ec3db1d0f3e2262827eba922bc5.png)  
![e1c49626083fe021500828efad948543.png](../_resources/e1c49626083fe021500828efad948543.png)

Выбираем 2, ждем, нажимаем любую кнопку по окончанию, затем выбираем 1, ждем, нажимаем любую кнопку по окончанию и нажимаем 0 для выхода:  
![bca5d3069cce4049014b3e4d6e669fd2.png](../_resources/bca5d3069cce4049014b3e4d6e669fd2.png)  
![8107dec9fcb1a2c29447a78b56ae43d5.png](../_resources/8107dec9fcb1a2c29447a78b56ae43d5.png)  
![aff0d648a3d10e82d53140021ea71b21.png](../_resources/aff0d648a3d10e82d53140021ea71b21.png)

Закрываем архиватор, удаляем файл со стола и включаем обратно антивирус.

## Клавиатура, системная локаль и языки интерфейса:

### Добавляем языки

1.  Пуск - Шестеренка (Settings) - Time & Language - Language & region
2.  Жмем Add a language
3.  Поиском или прокруткой ищем нужный, тыкаем в него и в Next
4.  Не меняем ничего на следующем экране (как на картинке), Install
5.  Пока ждем установки пакетов локализации повторяем пункты с 2 по 6 если необходимо добавить ещё языков интерфейса и клавиатур.  
    ![57a33f56484f7029d3ccbe5d9cfe25f6.png](../_resources/57a33f56484f7029d3ccbe5d9cfe25f6.png)  
    ![3fedbb8f8ceb641c166dc9822236973a.png](../_resources/3fedbb8f8ceb641c166dc9822236973a.png)  
    ![4de9044a2b7db3f66d184e061a148542.png](../_resources/4de9044a2b7db3f66d184e061a148542.png)  
    ![0528dcf24c020e5ae2efe3021ff7a517.png](../_resources/0528dcf24c020e5ae2efe3021ff7a517.png)

По окончанию установки всех желаемых языков - выбираем тот, что хотим видеть для своего аккаунта основным:  
![f7c70bb3c966b78d0b4d55380e9a76e5.png](../_resources/f7c70bb3c966b78d0b4d55380e9a76e5.png)  
Система тут же предложит выйти-зайти, пока не делаем этого:  
![c6347c575a1826ce4b8b6786a91125e3.png](../_resources/c6347c575a1826ce4b8b6786a91125e3.png)

Далее ниже выбираем **Typing**  
![ed6d512b8499346da1cc87a2722f36bc.png](../_resources/ed6d512b8499346da1cc87a2722f36bc.png)  
и Advanced keyboard settings  
![6e3df086e2f4b7570e4e0608a151aa65.png](../_resources/6e3df086e2f4b7570e4e0608a151aa65.png)  
Тут можно и нужно выбрать раскладку клавиатуры которая будет у пользователя по умолчанию. Рекомендуется выбрать **English (United States) - US**, это раскладка должна быть всегда и у всех, на ней безопаснее всего вводить пароли и потому неплохо бы ей быть по умолчанию.  
![297ea50ad98f7092ae69d1f8eda0927e.png](../_resources/297ea50ad98f7092ae69d1f8eda0927e.png)  
Там же можно поставить флаг **Let me use a different input method for each app window** - система будет запоминать в каком окне какая раскладка выбрана и само переключать при переключении окон. Кому то нравится, кого то раздражает, полезно знать где эта настройка.

Возвращаемся в Time & language > Language & region  
Проматываем ниже и жмем Administrative language settings:  
![6604d80087c0e7cf2bb27dc2da76881e.png](../_resources/6604d80087c0e7cf2bb27dc2da76881e.png)

Откроется окно, на второй вкладке Administrative жмем **Change system locale...**  
Тут сложно, нужно выбрать тот язык, на котором есть вероятность запуска старых программ или игр, либо чего то с колхозным переводом.  
Например, хотим иногда запускать игру 2004 года которую руссефецеравол какой то лютый пират из нулевых - выбераем Russian (Russia).  
Жмем ОК, оно тут же предложит перезагрузится - отказываемся - Later.  
![ac56f8f85cc0cfc4d4ba661d579a2c35.png](../_resources/ac56f8f85cc0cfc4d4ba661d579a2c35.png)  
![89e4371fe7e1088e10ce225dbd132037.png](../_resources/89e4371fe7e1088e10ce225dbd132037.png)  
![33f0dfd8f8ef7884fca2cbc4f0ede429.png](../_resources/33f0dfd8f8ef7884fca2cbc4f0ede429.png)

Жмем **Copy settings...**  
![4a4fdd50d8fbe8e09ac6c98f94657ad4.png](../_resources/4a4fdd50d8fbe8e09ac6c98f94657ad4.png)  
Тут показаны наши языковые настройки, настройки которые будут на экране входа в систему и то, что будет у новых пользователей по умолчанию.  
И два флага которые могут привнести наши настройки на экран входа и всем новым пользователям, соответственно. Причем первый заменяет оба, а второй может работать отдельно, но лучше поставить оба ибо реализовано кривовато.  
Таким образом, выбрав себе (временно, например) какой то язык и клавиатуру - мы можем это распространить.  
![90cd8a02753de4c3dba903899a023092.png](../_resources/90cd8a02753de4c3dba903899a023092.png)

Система предложит перезагрузится, соглашаемся.

### Создание других пользователей

Основной аккаунт, как первый на компе - с административными правами, рекомендуется для всех остальных пользователей сделать свои отдельные аккаунты без таковых прав.  
Пуск - Параметры (Settings) - Учетные записи (Accounts) - Other users (Другие пользователи) либо Семья (Family)  
![71b35a9a7ebcf3d3086c81edd5db1ca5.png](../_resources/71b35a9a7ebcf3d3086c81edd5db1ca5.png)  
В обоих случаях можно добавить пользователей как с Microsoft Account так и без них, а так же непосредственно в настройках его создать. Отличие в том, что в семейном разделе можно создавать не просто пользователей, а специальные аккаунты для детей, настроить цензуру и т.п. Работоспособность всего этого вызывает сомнения.

## Важное в биосе и подключение обратно остальных накопителей

Заходим в биос, смотрим на Boot Order - там должна быть одна запись - Windows Boot Manager и перед или после этих слов некая информация о накопителе на котором стоит система, это может быть цифра или его уникальный номер, записываем это.  
Выключаем компьютер, возвращаем отключенные перед установкой старые накопители, включаем и сразу бежим в биос.  
**Загрузка старой системы чревата повреждением загрузчика новой системы.**  
Поэтому ещё раз смотрим на Boot Order и делаем так, что бы в нем была **только одна** запись - тот Windows Boot Manager с теми цифрами или кодом который записали ранее. Выходим с сохранением.